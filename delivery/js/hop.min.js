function XDM_onload(){top==window.parent?XDM.send(top,"Liftium.iframeHop",[window.location]):XDM.send(top,"Liftium.iframeHop",[document.referrer])}var XDM={allowedMethods:[],debugOn:!1,iframeUrl:"/liftium_iframe.html",postMessageEnabled:!0};XDM.send=function(a,b,c){return XDM.debug("XDM.send called from "+document.location.hostname),typeof b!="string"?(XDM.debug("Bad argument for XDM.send, 'method' is not a string, ("+typeof b+")"),!1):(typeof c=="undefined"&&(c=[]),XDM.canPostMessage()?XDM._postMessage(a,b,c):XDM._postMessageWithIframe(a,b,c))},XDM.getDestinationDomain=function(a){if(a==top){if(document.referrer.toString()!==""){var b=document.referrer.toString().match(/https*:\/\/([^\/]+)/);return XDM.debug("Hostname for destWin set to "+b[1]+" using referrer"),b[1]}return!1}return a.location.hostname},XDM._postMessage=function(a,b,c){XDM.debug("Sending message using postMessage()");var d=XDM.getDestinationDomain(a),e;d===!1?e="*":e="http://"+d;var f=XDM.serializeMessage(b,c);if(a.postMessage)return a.postMessage(f,e);if(a.document.postMessage)return a.document.postMessage(f,e);throw"No supported way of using postMessage"},XDM._postMessageWithIframe=function(a,b,c){XDM.debug("Sending message using iframe");if(XDM.iframeUrl===null)return XDM.debug("Iframe method called, but no html file is specified"),!1;var d=XDM.getDestinationDomain(a),e;if(d===!1)return!1;e="http://"+d,d.match(/brighthub/)&&(XDM.iframeUrl="/liftium_iframe.htm");var f=e+XDM.iframeUrl+"?"+XDM.serializeMessage(b,c);return XDM.debug("Calling iframe dispatch url: "+f),typeof XDM.iframe=="undefined"&&(XDM.iframe=document.createElement("iframe"),XDM.iframe.style.display="none",XDM.iframe.width=0,XDM.iframe.height=0,document.body===null&&document.firstChild.appendChild(document.createElement("body")),document.body.appendChild(XDM.iframe)),XDM.iframe.src=f,!1},XDM.serializeMessage=function(a,b){var c="method="+escape(a.toString()),d;for(var e=0;e<b.length;e++)d=e+1,c+=";arg"+d+"="+escape(b[e]);return XDM.debug("Serialized message: "+c),c},XDM.canPostMessage=function(){return XDM.postMessageEnabled===!1?!1:window.postMessage||window.document.postMessage?!0:!1},XDM.debug=function(a){XDM.debugOn&&typeof console!="undefined"&&typeof console.log!="undefined"&&console.log("XDM debug: "+a)},XDM.listenForMessages=function(a){if(!XDM.canPostMessage())return!0;if(window.addEventListener)return window.addEventListener("message",a,!1);if(window.attachEvent)return window.attachEvent("onmessage",a)},XDM.isAllowedMethod=function(a){var b=!1;for(var c=0;c<XDM.allowedMethods.length;c++)if(a.toString()===XDM.allowedMethods[c]){b=!0;break}return b},XDM.executeMessage=function(serializedMessage){var nvpairs=XDM.parseQueryString(serializedMessage);if(XDM.isAllowedMethod(nvpairs.method)){var functionArgs=[],code=nvpairs.method;for(var prop in nvpairs)prop.substring(0,3)=="arg"&&functionArgs.push(nvpairs[prop].replace(/"/g,'\\"'));return functionArgs.length>0?code+='("'+functionArgs.join('","')+'");':code+="();",top!=self&&(nvpairs.destWin=nvpairs.destWin||"top",code=nvpairs.destWin+"."+code),XDM.debug("Evaluating "+code),eval(code)}return XDM.debug("Invalid method from XDM: "+nvpairs.method),!1},XDM.parseQueryString=function(a){var b=[];if(typeof a!="string")return b;a.charAt(0)==="?"&&(a=a.substr(1)),a=a.replace(/\;/g,"&",a);var c=a.split("&");for(var d=0,e;d<c.length;d++){if(c[d].length===0)continue;var f="",g="";(e=c[d].indexOf("="))!=-1?(f=decodeURIComponent(c[d].substr(0,e)),g=decodeURIComponent(c[d].substr(e+1))):(f=c[d],g=!0),b[f]=g}return b},top!=self?document.referrer&&document.referrer.match(/(liftium.com|liftium.wikia-inc.com)/)?document.write("<h3>Tag successfully called Liftium's hop.js. On the live site, it would have called the next ad in the chain.</h3>"):self.attachEvent?self.attachEvent("onload",XDM_onload):XDM_onload():(window.Liftium.debug("Liftium.hop() called from hop.js",3),window.Liftium.hop());
